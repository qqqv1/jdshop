<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhou.jdshop.dao.OrdersCustomMapper">



  <sql id="Base_Column_List">
    o.oid,
    o.ordertime,
    o.total,
    o.state,
    o.address,
    o.name,
    o.telephone,

    oi.itemid,
    oi.count,
    oi.subtotal,

    p.pname

  </sql>
  <!--CASE-->
  <!--o.state-->
  <!--WHEN 0 THEN '已删除'-->
  <!--WHEN 1 THEN '未支付'-->
  <!--WHEN 2 THEN '已支付,未发货'-->
  <!--WHEN 3 THEN '已支付,并发货'-->
  <!--WHEN 4 THEN '已完成'-->
  <!--ELSE '未知' END as status-->

  <select id="selectByExample" resultType="com.zhou.jdshop.pojo.vo.OrdersCustom">

    select
    <include refid="Base_Column_List" />
    from TbOrderItem oi  left join TbOrder o on o.oid=oi.oid

    LEFT JOIN product p on oi.pid=p.pid
    where o.state!=0
    order by o.oid

  </select>


    <select id="selectOrderById" resultType="com.zhou.jdshop.pojo.vo.OrdersCustom">

        select
        <include refid="Base_Column_List" />
        from TbOrderItem oi left join TbOrder o on oi.oid=o.oid
        LEFT JOIN product p on oi.pid=p.pid

        WHERE oi.itemid=#{itemid} AND   o.state!=0

    </select>

</mapper>